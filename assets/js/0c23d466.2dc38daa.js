"use strict";(self.webpackChunksushi_docs=self.webpackChunksushi_docs||[]).push([[5461],{3905:function(e,t,o){o.d(t,{Zo:function(){return p},kt:function(){return d}});var n=o(67294);function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function i(e,t){if(null==e)return{};var o,n,a=function(e,t){if(null==e)return{};var o,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||(a[o]=e[o]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var l=n.createContext({}),u=function(e){var t=n.useContext(l),o=t;return e&&(o="function"==typeof e?e(t):s(s({},t),e)),o},p=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var o=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),h=u(o),d=a,m=h["".concat(l,".").concat(d)]||h[d]||c[d]||r;return o?n.createElement(m,s(s({ref:t},p),{},{components:o})):n.createElement(m,s({ref:t},p))}));function d(e,t){var o=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=o.length,s=new Array(r);s[0]=h;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:a,s[1]=i;for(var u=2;u<r;u++)s[u]=o[u];return n.createElement.apply(null,s)}return n.createElement.apply(null,o)}h.displayName="MDXCreateElement"},23152:function(e,t,o){o.r(t),o.d(t,{assets:function(){return p},contentTitle:function(){return l},default:function(){return d},frontMatter:function(){return i},metadata:function(){return u},toc:function(){return c}});var n=o(87462),a=o(63366),r=(o(67294),o(3905)),s=["components"],i={sidebar_position:1},l="Overview",u={unversionedId:"Developers/Bentobox/Overview",id:"Developers/Bentobox/Overview",title:"Overview",description:"The BentoBox is a vault that holds tokens and generates yield from flash loans and strategies for any protocol built on top of it.",source:"@site/docs/Developers/Bentobox/Overview.md",sourceDirName:"Developers/Bentobox",slug:"/Developers/Bentobox/Overview",permalink:"/docs/Developers/Bentobox/Overview",draft:!1,editUrl:"https://github.com/sushiswap/sushi-docs/edit/master/docs/Developers/Bentobox/Overview.md",tags:[],version:"current",lastUpdatedBy:"Genghis Goose",lastUpdatedAt:1656183667,formattedLastUpdatedAt:"6/25/2022",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"docsSidebar",previous:{title:"BentoBox",permalink:"/docs/Developers/Bentobox/"},next:{title:"KashiPairMediumRiskV1",permalink:"/docs/Developers/Bentobox/KashiPairMediumRiskV1"}},p={},c=[{value:"Single Vault",id:"single-vault",level:3},{value:"Flash Loans",id:"flash-loans",level:3},{value:"Strategies",id:"strategies",level:3},{value:"Amounts and Shares",id:"amounts-and-shares",level:3},{value:"Batching",id:"batching",level:3},{value:"Supported Tokens",id:"supported-tokens",level:3},{value:"Minimum Token Balance",id:"minimum-token-balance",level:3},{value:"Multiple Protocols and Master Contracts",id:"multiple-protocols-and-master-contracts",level:3},{value:"Approval of Protocols (Master Contracts)",id:"approval-of-protocols-master-contracts",level:3}],h={toc:c};function d(e){var t=e.components,o=(0,a.Z)(e,s);return(0,r.kt)("wrapper",(0,n.Z)({},h,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"overview"},"Overview"),(0,r.kt)("p",null,"The BentoBox is a vault that holds tokens and generates yield from flash loans and strategies for any protocol built on top of it."),(0,r.kt)("p",null,"Building on top of Bentobox provides these benefits:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Extra yield from flash loans")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Extra yield from strategies")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Optimized deposit, withdraw and skim functions that auto convert ETH to WETH")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Low gas (and fixed gas!) transfers of tokens within Bentobox")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Simplified approval of tokens (no need to reapprove for each protocol)")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Minimal proxy contract factory is built in; no need to roll your own!"))),(0,r.kt)("h3",{id:"single-vault"},"Single Vault"),(0,r.kt)("p",null,"Placing your tokens in a single vault brings a range of benefits. As more protocols get added to the BentoBox, gas costs will come down, while composability, capital efficiency and flexibility will go up."),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Not all tokens are created equal.")," Some have very high gas costs, some are not quite ERC-20 compliant. Once they are stored in the BentoBox, you can use your tokens in any BentoBox enabled protocols. These protocols don't have to worry about any token quirks or handle $ETH. The BentoBox takes care of all that. On top of that, tokens in the BentoBox will generate extra returns through flash loans and potentially a token strategy."),(0,r.kt)("h3",{id:"flash-loans"},"Flash Loans"),(0,r.kt)("p",null,"Tokens in the BentoBox can be flash loaned. The fee is 0.05% and this fee goes to the share owners in the BentoBox. Multiple assets can be flash loaned at the same time."),(0,r.kt)("p",null,"ERC-3156 wasn't final at release of the BentoBox and the BentoBox is not ERC-3156 compliant at this time. The BentoBox uses push instead of pull to get the returned funds. This is for flexibility and security reasons."),(0,r.kt)("h3",{id:"strategies"},"Strategies"),(0,r.kt)("p",null,"The BentoBox has a simple strategy system per token. A strategy is a contract that invests a single token for profit and returns the profit in that same token. The safest strategies would be those that:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Can only ever grow in token amount - principal is always safe")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Can be deposited and withdrawn at will"))),(0,r.kt)("p",null,"Some examples of this would be:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"The SushiBar: $SUSHI can be invested and held as xSUSHI")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Staking contracts, such as MasterChef and Onsen"))),(0,r.kt)("p",null,"It will be up to the community and the Sushi team to decide which strategies are safe enough to enable. The BentoBox has a hardcoded 2 week waiting period for enabling or changing strategies."),(0,r.kt)("h3",{id:"amounts-and-shares"},"Amounts and Shares"),(0,r.kt)("p",null,"When you deposit token in the BentoBox, you receive a number of shares. This represents your shares of the total token amount in the BentoBox. As the amount of tokens grows due to flash loan fees and profit from strategies, you will get your share of that. Simply depositing tokens into the BentoBox can provide returns."),(0,r.kt)("p",null,"Because of limited precision in the accounting, there will be small rounding differences. For most tokens these will be incredibly small and have no useful value. In the top 100 tokens, currently $XAUT is worth the most for a single accounting unit, at about $0.00185. BentoBox is designed to never round in your favour, because that could be exploited by clever hackers. But because of this, when you deposit 100 tokens and withdraw it straight away, you may only receive for instance 99.9999."),(0,r.kt)("h3",{id:"batching"},"Batching"),(0,r.kt)("p",null,"The batch function allows the batching of multiple BentoBox function calls in a single transaction."),(0,r.kt)("h3",{id:"supported-tokens"},"Supported Tokens"),(0,r.kt)("p",null,"While most ERC-20 tokens are supported by the BentoBox, there are some tokens that should not be deposited into the BentoBox:"),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Rebasing tokens are not directly supported.")," Since rebasing is just a visual (psychological) trick rather than an actual feature, direct support was not added. However, most rebasing tokens could easily be wrapped exposing the underlying balances as an ERC-20 token. These could be deposited into the BentoBox without problem."),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Tokens where a single 'unit' has significant value.")," Due to rounding and gas optimizations, it is possible to craft transactions that will give you 'free' units of a token. In case of a token, such as $SUSHI, with 18 decimals, this would be worth about $0.00000000000000001. As long as gas costs are more than this, it's safe. In the case of $WBTC, 1 unit is about $0.00033, which still has a safety margin of about 4 orders of magnitude. There may however be some tokens with low or no decimals and a high value that should not be added to the BentoBox."),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Tokens where the totalSupply in token units is greater than uint128, which is about 38 decimals.")," With a maximum of 18 decimals normally used, this would still allow for a totalSupply of 100.000.000.000.000.000.000, which is more than enough. While ERC-20 supports uint256, this limit was added to save on gas."),(0,r.kt)("h3",{id:"minimum-token-balance"},"Minimum Token Balance"),(0,r.kt)("p",null,"To prevent a far-fetched grieving attack on the amount to share ratio, a minimum of 1000 shares of each token have to remain in the BentoBox ",(0,r.kt)("strong",{parentName:"p"},"OR")," it has to be emptied completely. Normally this is an insignificant amount, and even in the case of $WBTC it's only $3.30. If you're the last user, you can fully withdraw your shares, so no funds are lost/inaccessible because of this."),(0,r.kt)("h3",{id:"multiple-protocols-and-master-contracts"},"Multiple Protocols and Master Contracts"),(0,r.kt)("p",null,"Any protocol can use BentoBox as its storage of funds; the contract just needs to implement the init function."),(0,r.kt)("h3",{id:"approval-of-protocols-master-contracts"},"Approval of Protocols (Master Contracts)"),(0,r.kt)("p",null,"For every new master contract, each user manually approves the protocol. Once approved, functions of the protocol contract have access to all funds of the user that are not in other protocols. Because this is quite a powerful approval, users tricked into approving a malicious contract could lose a lot of funds. To mitigate this and improve usability, the approval is done through a signed typed data message. A wallet such as Metamask will display the typed data, which includes this message:"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Give FULL access to funds in (and approved to) BentoBox?")),(0,r.kt)("p",null,"This will prompt users to the potential effects of the approval. Because some hardware wallets are unable to sign typed data, such as the Ledger, a fallback is available. The Sushi team has the ability to white-list master contracts so they can be approved by a simple contract call."))}d.isMDXComponent=!0}}]);